order_label(
group_var = group_var,
group_first = 'Right direction',
horizontal = TRUE
) %>%
arrange(label, group_var)
chart_grouped_hor_arrange <- ms_grouped_y2(
direction = 'horizontal',
title_label = 'orderlabel used'
)
# Save out charts ----------------------------------------------------------
doc <- read_pptx('~/Dropbox (Y2 Analytics)/Y2 Analytics Team Folder/Projects/Qualtrics/2021 Qualtrics Template Condensed.pptx')
# Single
doc <- add_section_header_y2('Single', n = '2')
doc <- add1c_y2(chart_single_vert)
doc <- add1c_y2(chart_single_hor)
# Grouped
doc <- add_section_header_y2('Grouped', n = '3')
doc <- add1c_y2(chart_grouped_vert)
doc <- add1c_y2(chart_grouped_hor)
doc <- add1c_y2(chart_grouped_hor_arrange)
print(
doc,
'~/Desktop/test.pptx'
)
responses %>% freqs(s_5year)
responses %>% freqs(s_sex)
# Horizontal w/orderlabel
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(s_marital, factor_group = TRUE) %>%
order_label(
group_var = group_var,
group_first = 'Right direction',
horizontal = TRUE
) %>%
arrange(label, group_var)
# Horizontal w/orderlabel
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(s_marital, factor_group = TRUE) %>%
order_label(
group_var = group_var,
horizontal = TRUE
) %>%
arrange(label, group_var)
# Horizontal w/orderlabel
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(s_marital, factor_group = TRUE) %>%
order_label(
group_var = group_var,
horizontal = TRUE
)
chart_grouped_hor_arrange <- ms_grouped_y2(
direction = 'horizontal',
title_label = 'orderlabel used'
)
# Save out charts ----------------------------------------------------------
doc <- read_pptx('~/Dropbox (Y2 Analytics)/Y2 Analytics Team Folder/Projects/Qualtrics/2021 Qualtrics Template Condensed.pptx')
# Horizontal w/orderlabel
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(s_marital, factor_group = TRUE) %>%
order_label(
group_var = group_var,
horizontal = TRUE
)
color_settings_grouped <- list(
'Male' = 'blue',
'Female' = 'red',
'In another way, specify if you wish' = 'grey'
)
text_settings_grouped <- list(
'Male' = fp_text(color = 'blue'),
'Female' = fp_text(color = 'red'),
'In another way, specify if you wish' = fp_text(color = 'grey')
)
chart_grouped_hor_arrange <- ms_grouped_y2(
direction = 'horizontal',
title_label = 'orderlabel used'
)
# Save out charts ----------------------------------------------------------
doc <- read_pptx('~/Dropbox (Y2 Analytics)/Y2 Analytics Team Folder/Projects/Qualtrics/2021 Qualtrics Template Condensed.pptx')
# Single
doc <- add_section_header_y2('Single', n = '2')
doc <- add1c_y2(chart_single_vert)
doc <- add1c_y2(chart_single_hor)
# Grouped
doc <- add_section_header_y2('Grouped', n = '3')
doc <- add1c_y2(chart_grouped_vert)
doc <- add1c_y2(chart_grouped_hor)
doc <- add1c_y2(chart_grouped_hor_arrange)
print(
doc,
'~/Desktop/test.pptx'
)
# Horizontal w/orderlabel
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(s_marital, factor_group = TRUE) %>%
order_label(
group_var = group_var,
group_first = 'Male',
horizontal = TRUE
)
# Horizontal w/orderlabel
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(s_marital, factor_group = TRUE) %>%
order_label(
group_var = group_var,
group_first = 'Male',
horizontal = TRUE
)
color_settings_grouped <- list(
'Male' = 'blue',
'Female' = 'red',
'In another way, specify if you wish' = 'grey'
)
text_settings_grouped <- list(
'Male' = fp_text(color = 'blue'),
'Female' = fp_text(color = 'red'),
'In another way, specify if you wish' = fp_text(color = 'grey')
)
chart_grouped_hor_arrange <- ms_grouped_y2(
direction = 'horizontal',
title_label = 'orderlabel used'
)
# Save out charts ----------------------------------------------------------
doc <- read_pptx('~/Dropbox (Y2 Analytics)/Y2 Analytics Team Folder/Projects/Qualtrics/2021 Qualtrics Template Condensed.pptx')
# Single
doc <- add_section_header_y2('Single', n = '2')
doc <- add1c_y2(chart_single_vert)
doc <- add1c_y2(chart_single_hor)
# Grouped
doc <- add_section_header_y2('Grouped', n = '3')
doc <- add1c_y2(chart_grouped_vert)
doc <- add1c_y2(chart_grouped_hor)
doc <- add1c_y2(chart_grouped_hor_arrange)
print(
doc,
'~/Desktop/test.pptx'
)
# Horizontal w/orderlabel
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(s_marital, factor_group = TRUE) %>%
order_label(
group_var = group_var,
group_first = 'Male',
horizontal = TRUE
) %>%
arrange(label, group_var)
color_settings_grouped <- list(
'Male' = 'blue',
'Female' = 'red',
'In another way, specify if you wish' = 'grey'
)
text_settings_grouped <- list(
'Male' = fp_text(color = 'blue'),
'Female' = fp_text(color = 'red'),
'In another way, specify if you wish' = fp_text(color = 'grey')
)
chart_grouped_hor_arrange <- ms_grouped_y2(
direction = 'horizontal',
title_label = 'orderlabel used'
)
# Save out charts ----------------------------------------------------------
doc <- read_pptx('~/Dropbox (Y2 Analytics)/Y2 Analytics Team Folder/Projects/Qualtrics/2021 Qualtrics Template Condensed.pptx')
# Single
doc <- add_section_header_y2('Single', n = '2')
doc <- add1c_y2(chart_single_vert)
doc <- add1c_y2(chart_single_hor)
# Grouped
doc <- add_section_header_y2('Grouped', n = '3')
doc <- add1c_y2(chart_grouped_vert)
doc <- add1c_y2(chart_grouped_hor)
doc <- add1c_y2(chart_grouped_hor_arrange)
print(
doc,
'~/Desktop/test.pptx'
)
# Stacked -----------------------------------------------------------------
responses <- responses %>%
mutate(
scale4 = case_when(
n_overall_1 <= 25 ~ 'One',
n_overall_1 <= 50 ~ 'Two',
n_overall_1 <= 75 ~ 'Three',
n_overall_1 <= 100 ~ 'Four'
)
)
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(scale4, factor_group = TRUE) %>%
order_label(
group_var = group_var,
group_first = 'Male',
stacked = 'ms'
) %>%
arrange(label, group_var)
# Stacked -----------------------------------------------------------------
responses <- responses %>%
mutate(
scale4 = case_when(
n_overall_1 <= 25 ~ 'One',
n_overall_1 <= 50 ~ 'Two',
n_overall_1 <= 75 ~ 'Three',
n_overall_1 <= 100 ~ 'Four'
)
)
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(scale4, factor_group = TRUE) %>%
order_label(
group_var = group_var,
group_first = 'Male',
stacked = 'ms'
) %>%
arrange(label, group_var)
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(scale4, factor_group = TRUE) %>%
order_label(
group_var = group_var,
group_first = 'Male',
stacked = 'ms'
)
color_settings_stacked <- list(
'One' = 'red',
'Two' = 'orange',
'Three' = 'yellow',
'Four' = 'green'
)
text_settings_stacked <- list(
'Male' = fp_text(color = 'white'),
'Female' = fp_text(color = 'white'),
'Female' = fp_text(color = 'white'),
'Female' = fp_text(color = 'white')
)
chart_stacked <- ms_grouped_y2(
direction = 'horizontal',
title_label = 'orderlabel used'
)
doc <- read_pptx('~/Dropbox (Y2 Analytics)/Y2 Analytics Team Folder/Projects/Qualtrics/2021 Qualtrics Template Condensed.pptx')
# Single
doc <- add_section_header_y2('Single', n = '2')
doc <- add1c_y2(chart_single_vert)
doc <- add1c_y2(chart_single_hor)
# Grouped
doc <- add_section_header_y2('Grouped', n = '3')
doc <- add1c_y2(chart_grouped_vert)
doc <- add1c_y2(chart_grouped_hor)
doc <- add1c_y2(chart_grouped_hor_arrange)
# Stacked
doc <- add_section_header_y2('Stacked', n = '4')
doc <- add1c_y2(chart_stacked)
print(
doc,
'~/Desktop/test.pptx'
)
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(scale4, factor_group = TRUE) %>%
order_label(
group_var = group_var,
group_first = 'Male',
stacked = 'ms'
)
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(scale4, factor_group = TRUE) %>%
order_label(
group_var = group_var,
group_first = 'Male',
stacked = 'ms'
)
# Stacked -----------------------------------------------------------------
responses <- responses %>%
mutate(
scale4 = case_when(
n_overall_1 <= 25 ~ 'One',
n_overall_1 <= 50 ~ 'Two',
n_overall_1 <= 75 ~ 'Three',
n_overall_1 <= 100 ~ 'Four'
) %>%
fct_relevel('One', 'Two', 'Three', 'Four')
)
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(scale4, factor_group = TRUE) %>%
order_label(
group_var = group_var,
group_first = 'Male',
stacked = 'ms'
)
color_settings_stacked <- list(
'One' = 'red',
'Two' = 'orange',
'Three' = 'yellow',
'Four' = 'green'
)
text_settings_stacked <- list(
'Male' = fp_text(color = 'white'),
'Female' = fp_text(color = 'white'),
'Female' = fp_text(color = 'white'),
'Female' = fp_text(color = 'white')
)
chart_stacked <- ms_stacked_y2(
title_label = 'orderlabel used'
)
text_settings_stacked <- list(
'One' = fp_text(color = 'white'),
'Two' = fp_text(color = 'white'),
'Three' = fp_text(color = 'white'),
'Four' = fp_text(color = 'white')
)
chart_stacked <- ms_stacked_y2(
title_label = 'orderlabel used'
)
# Save out charts ----------------------------------------------------------
doc <- read_pptx('~/Dropbox (Y2 Analytics)/Y2 Analytics Team Folder/Projects/Qualtrics/2021 Qualtrics Template Condensed.pptx')
# Single
doc <- add_section_header_y2('Single', n = '2')
doc <- add1c_y2(chart_single_vert)
doc <- add1c_y2(chart_single_hor)
# Grouped
doc <- add_section_header_y2('Grouped', n = '3')
doc <- add1c_y2(chart_grouped_vert)
doc <- add1c_y2(chart_grouped_hor)
doc <- add1c_y2(chart_grouped_hor_arrange)
# Stacked
doc <- add_section_header_y2('Stacked', n = '4')
doc <- add1c_y2(chart_stacked)
print(
doc,
'~/Desktop/test.pptx'
)
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(scale4, factor_group = TRUE) %>%
order_label(
group_var = group_var,
group_first = 'Male',
stacked = 'ms'
) %>%
arrange(label, group_var)
color_settings_stacked <- list(
'One' = 'red',
'Two' = 'orange',
'Three' = 'yellow',
'Four' = 'green'
)
text_settings_stacked <- list(
'One' = fp_text(color = 'black'),
'Two' = fp_text(color = 'black'),
'Three' = fp_text(color = 'black'),
'Four' = fp_text(color = 'black')
)
chart_stacked <- ms_stacked_y2(
title_label = 'orderlabel used'
)
# Save out charts ----------------------------------------------------------
doc <- read_pptx('~/Dropbox (Y2 Analytics)/Y2 Analytics Team Folder/Projects/Qualtrics/2021 Qualtrics Template Condensed.pptx')
# Single
doc <- add_section_header_y2('Single', n = '2')
doc <- add1c_y2(chart_single_vert)
doc <- add1c_y2(chart_single_hor)
# Grouped
doc <- add_section_header_y2('Grouped', n = '3')
doc <- add1c_y2(chart_grouped_vert)
doc <- add1c_y2(chart_grouped_hor)
doc <- add1c_y2(chart_grouped_hor_arrange)
# Stacked
doc <- add_section_header_y2('Stacked', n = '4')
doc <- add1c_y2(chart_stacked)
print(
doc,
'~/Desktop/test.pptx'
)
# gg single ---------------------------------------------------------------
frequencies <- responses %>%
freqs(s_marital) %>%
order_label() %>%
arrange(label)
chart <- gg_single_y2()
chart <- gg_single_y2(font_family = 'sans')
CHART_PATH <- '~/Desktop/'
chart %>% ggchart_save_y2('test')
# vert
frequencies <- responses %>%
freqs(s_marital) %>%
order_label(horizontal = TRUE) %>%
arrange(label)
chart <- gg_single_y2(font_family = 'sans', direction = 'horizontal')
chart %>% ggchart_save_y2('test')
# vert
frequencies <- responses %>%
freqs(s_marital) %>%
order_label(horizontal = TRUE) %>%
arrange(label)
chart <- gg_single_y2(font_family = 'sans', direction = 'horizontal')
chart %>% ggchart_save_y2('test')
# gg grouped ---------------------------------------------------------------
# vert
frequencies <- responses %>%
group_by(s_direction) %>%
freqs(s_marital) %>%
order_label(group_var = group_var) %>%
arrange(label)
# gg grouped ---------------------------------------------------------------
# vert
frequencies <- responses %>%
group_by(s_direction) %>%
freqs(s_marital, factor_group = TRUE) %>%
order_label(group_var = group_var) %>%
arrange(label)
chart <- gg_single_y2(font_family = 'sans')
chart %>% ggchart_save_y2('test')
# gg grouped ---------------------------------------------------------------
# vert
frequencies <- responses %>%
group_by(s_direction) %>%
freqs(s_marital, factor_group = TRUE) %>%
order_label(group_var = group_var) %>%
arrange(label)
chart <- gg_grouped_y2(font_family = 'sans')
chart %>% ggchart_save_y2('test')
# gg grouped ---------------------------------------------------------------
# vert
frequencies <- responses %>%
group_by(s_direction) %>%
freqs(s_marital, factor_group = TRUE) %>%
order_label(group_var = group_var) %>%
arrange(label)
chart <- gg_grouped_y2(font_family = 'sans', fills = c('blue', 'grey'))
chart %>% ggchart_save_y2('test')
# vert
frequencies <- responses %>%
group_by(s_direction) %>%
freqs(s_marital, factor_group = TRUE) %>%
order_label(group_var = group_var, horizontal = TRUE) %>%
arrange(label)
# hor
frequencies <- responses %>%
group_by(s_direction) %>%
freqs(s_marital, factor_group = TRUE) %>%
order_label(group_var = group_var, horizontal = TRUE) %>%
arrange(label)
chart <- gg_grouped_y2(font_family = 'sans', direction = 'horizontal', fills = c('blue', 'grey'))
chart %>% ggchart_save_y2('test')
# gg grouped ---------------------------------------------------------------
# vert
frequencies <- responses %>%
group_by(s_direction) %>%
freqs(s_marital, factor_group = TRUE) %>%
order_label(group_var = group_var) %>%
arrange(label)
chart <- gg_grouped_y2(font_family = 'sans', fills = c('blue', 'grey'))
chart %>% ggchart_save_y2('test')
# gg stacked --------------------------------------------------------------
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(scale4, factor_group = TRUE) %>%
order_label(
group_var = group_var,
group_first = 'Male',
stacked = 'ms'
) %>%
arrange(label, group_var)
# gg stacked --------------------------------------------------------------
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(scale4, factor_group = TRUE) %>%
order_label(
group_var = group_var,
group_first = 'Male',
stacked = 'ms'
) %>%
arrange(label, group_var)
chart <- gg_stacked_y2(fills = c('red', 'orange', 'yellow', 'green'))
chart <- gg_stacked_y2(fills = c('red', 'orange', 'yellow', 'green'), font_family = 'sans')
chart %>% ggchart_save_y2('test')
# gg stacked --------------------------------------------------------------
frequencies <- responses %>%
group_by(s_sex) %>%
freqs(scale4, factor_group = TRUE) %>%
order_label(
group_var = group_var,
group_first = 'Male',
stacked = 'gg'
) %>%
arrange(label, group_var)
chart <- gg_stacked_y2(fills = c('red', 'orange', 'yellow', 'green'), font_family = 'sans')
chart %>% ggchart_save_y2('test')
# arrange_by_factor: mschart htmltools updated ordering --------------------------------------
arrange_by_factor <- function(
dataset,
grouped
) {
if (grouped == FALSE) {
dataset <- dataset %>%
arrange(.data$label)
} else {
dataset <- dataset %>%
arange(
.data$label,
.data$group_var
)
}
}
